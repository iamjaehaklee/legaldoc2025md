이 파일은  웹서비스의 핵심 개념을 정의한다. 
---------------------------------


# [프로젝트분석]

## [프로젝트분석 트리구조]
```
프로젝트분석
├── 상대방(Opponent)
│   └── 유형별 구분
│       ├── 민사: 개인/법인
│       ├── 형사: 검찰/경찰
│       ├── 조세: 과세관청
│       ├── 행정: 행정청
│       ├── 금융: 금융감독원
│       └── 공정거래: 공정거래위원회
│
├── 분석구조
│   ├── 우리측 입장 분석
│   │   ├── 목표(Goal)
│   │   │   ├── 유형1: 상대방으로부터 금전/물건/권리 획득
│   │   │   ├── 유형2: 상대방의 청구에 대한 방어
│   │   │   ├── 유형3: 유리한 계약/합의 체결
│   │   │   ├── 유형4: 법적판단기관의 유리한 결정
│   │   │   ├── 유형5: 과다 과세/세무조사 예방
│   │   │   └── 유형6: 장래 리스크 예방
│   │   │
│   │   ├── 주장(Claim)
│   │   │   ├── 법적 논점/입장
│   │   │   └── 뒷받침 자료: 법령, 판례, 프로젝트최종결정문, 참고자료
│   │   │
│   │   └── 사실(Fact)
│   │       ├── 6하원칙에 따른 추출내용
│   │       ├── 뒷받침 자료: 증거자료, 주장서류
│   │       └── 계층적 구조
│   │           ├── 포괄적/추상적 사실
│   │           └── 구체적/세분화된 하위 사실
│   │
│   ├── 상대방측 입장 분석
│   │   ├── 상대방 예상 목표(Goal)
│   │   ├── 상대방 예상 주장(Claim)
│   │   │   └── 뒷받침 자료
│   │   ├── 상대방 예상 사실(Fact)
│   │   │   └── 뒷받침 자료
│   │   └── 우리측 대응 전략
│   │
│   └── 중립적 사실관계 분석
│       ├── 객관적 사실
│       └── 뒷받침 자료
```

## [상대방(Opponent)]
- 여기서 상대방은 민사인 경우 개인 또는 법인, 형사인 경우 수사기관(검찰, 경찰), 조세인 경우 과세관청, 행정처분/행정조사인 경우 행정청, 금융조사인 경우 금융감독원, 공정거래조사/처분인 경우 공정거래위원회 등임.

- **목표(Goal)**: 법률 업무에서 목표는 다음 중 하나를 의미합니다:
  1. 상대방으로부터 금전, 부동산 인도, 물건 명도, 권리 이전 등 구체적인 것을 얻어내는 것
  2. 상대방의 금전, 인도, 권리 이전 등 소송상의, 소송외의 청구에 대해 방어하는 것
  3. 상대방과 협상하여 유리한 조건의 계약/합의 체결을 달성하는 것
  4. 법원/검찰/경찰/행정청/과세당국/중재원 등 법적판단기관으로부터 유리한 결정을 받는 것
  5. 예상치 못한 과다한 조세 부과를 당하거나, 세무조사를 당하는 것을 예방하는 것
  6. 장래에 불특정인으로부터 소송, 고소, 청구, 언론폭로 등을 당하거나, 수사기관/행정청/과세당국 등으로부터 조사를 당할 리스크를 예방하는 것
  
  목표는 서로 중복되면 안 되며, 다른 목표들과 목적/수단 관계에 있어서도 안 됩니다. 목표는 궁극적으로 이루고자 하는 최종 결과물입니다.

- **주장(Claim)**: 주장은 목표를 달성하기 위한 구체적인 법적 논점이나 입장입니다. 각 주장은 하나 이상의 목표를 지원하며, 사실(Fact)과 프로젝트참고자료(ProjectReference) 중 법령, 판례, 프로젝트최종결정문, 참고자료에 의해 뒷받침되어야 합니다. 예를 들어, 손해배상금을 받는 것이 목표라면, "상대방의 계약 위반으로 손해가 발생했다"와 같은 내용이 주장이 됩니다.

- **사실(Fact)**: 사실은 프로젝트참고자료(ProjectReference) 중 증거자료, 주장서류에 의해 직접적으로 뒷받침되는, 6하원칙(가급적 달성하고자 하며, 주어, 일시, 목적어, 술어는 가급적 포함)에 따른 추출내용입니다. 사실은 계층적 구조를 가질 수 있으며, 포괄적/추상적/모호한 사실은 보다 구체적이고 세분화된 하위 사실들로 구성될 수 있습니다. 예를 들어, "을순이는 계약을 위반했다"라는 포괄적 사실은 "을순이는 2024. 4. 1. 16:23 부동산매매계약 잔금 100만원을 입금받았다", "을순이는 2024. 4. 1. 계약에서 정한 잔금지급기한을 준수하지 않았다" 등의 구체적인 하위 사실들로 세분화될 수 있습니다.

## [분석구조]
- **우리측 입장 분석**: 우리 측이 달성하고자 하는 목표(Goal)와 이를 뒷받침하는 주장(Claim), 사실(Fact), 주장 및 사실을 각각 뒷받침하는 자료를 계층적으로 구성하여 자신의 법적 입장을 체계화합니다.
- **상대방측 입장 분석**: 상대방의 예상 목표와 주장, 이를 뒷받침하는 사실, 주장 및 사실을 각각 뒷받침하는 자료를을 분석하고, 각 요소에 대한 우리 측의 대응 전략을 수립합니다.
- **중립적 사실관계 분석**: 양측의 주관적 해석을 배제한 객관적 사실 및 이를 각각 뒷받침하는 자료들만을 정리하여 사건의 본질을 파악하고, 법적 판단의 기초를 마련합니다.


---------------------------------

# [프로젝트데이터(ProjectData)]

## [작성문서(EditingDocument)]
- 유저가 이 앱에서 작성하였거나 작성 중인 문서

## [프로젝트참고자료(ProjectReference)]
### 증거자료 (Evidence) : 이 프로젝트의 사실관계를 뒷받침하는 자료들임. 우리가 제출할 수도 있고 상대방이 제출할 수도 있음. ('우리측 증거자료', '상대방 증거자료')
### 주장서류 (ClaimingDocument) : 우리측 및 상대측에서 주장을 하는 서면. 우리가 제출한 소장, 준비서면, 참고서면 등, 상대방이 제출한 소장, 준비서면, 참고서면 등.
### 법령 (Law) : 현재 효력이 있는 강제규범으로서의 법률
### 판례 (Precedent) : 법령의 해석 및 적용례로서, 사실상 강제규범으로 작용하는 선례
### 참고자료 (ConsiderableDocument) : 법령이나 판례는 아니지만, 사건에 참고할 만한 전거자료
### 프로젝트최종결정문 (ProjectFinalJudgement) : 분쟁 결과 법원이나 검찰, 행정기관 등이 종국적으로 내린 판단. 일단 내려진 판정 결과이므로 이것에 대해 어떻게 다툴 것인지 검토해야 함.  

---------------------------------

# [AIAgent]

## [모드별 기능 정의]
- **Ask 모드**: 사용자의 질문에 프로젝트 데이터를 기반으로 답변하는 기능입니다. 이 모드에서는 문서 수정 없이 정보 제공과 검색만 수행합니다. 사용자가 물어볼 수 있는 질문의 예: "이 손해배상 사건에 적용 가능한 민법 조항은?", "이 증거자료가 어떤 주장을 뒷받침하는지?"
- **Write 모드**: 문서 생성 및 수정 지시를 수행하는 기능입니다. 사용자의 지시에 따라, 현재 사용자가 띄워서 보고 있는 UI상태에 부합하는 작업을 합니다. 프로젝트분석 항목 수정, 문서 작성, 증거자료 댓글 제안 등을 수행합니다. 주요 기능: 새 문서 초안 작성, 기존 문서 수정/보완, 법률 조항 추가, 논리 구조 개선 등
- **Review 모드**: 기존 문서의 법적 리스크, 오류, 개선사항 등을 검토하고 피드백을 제공하는 기능입니다. 주요 기능: 논리적 모순 검토, 법적 리스크 평가, 유사 판례 참조 제안, 문서 구조 및 내용 개선 제안 등

## [AI Agent 권한 체계]
- **기본 권한**: 모든 프로젝트 멤버는 AI Agent의 Ask 모드를 활용할 수 있습니다.
- **Write 권한**: Owner, Admin, Editor 역할을 가진 멤버만 활용 가능합니다.
- **Review 권한**: Owner, Admin, Editor, Commentator 역할을 가진 멤버가 활용 가능합니다.
- **승인 절차**: AI Agent가 Write 모드에서 생성/수정한 내용은 사용자의 승인을 거쳐야 최종 적용됩니다.

## [상호작용 방식]
- **컨텍스트 활용**: 
  - 현재 유저가 보고 있는 화면이 검색모달인지, 파일뷰어화면인지, 문서편집기화면인지, 프로젝트분석화면인지, 프로젝트분석요소검색모달인지 등 현재 화면에 따른 작업을 합니다. 
  - 현재 문서 에디터상의 커서 위치 기준 앞뒤 맥락을 AI Agent에게 전달하거나, 문서 에디터상에서 블록 지정하여 특정 부분만 AI Agent에게 전달할 수 있습니다.
- **응답 처리**: AI Agent의 응답은 채팅창에 표시되며, Write 모드의 경우 수정된 내용에 대해 승인/거부 선택이 가능합니다.
- **연속 대화**: 승인/거부를 선택하지 않은 채로 다시 AI Agent에게 질문하거나 지시를 내릴 수 있어 맥락이 유지된 연속적인 상호작용이 가능합니다.
- **버튼 선택지 제시**: 어느 제목의 문서를 생성할 것인지 문서 제목들 추천, 수 개의 파일들 중 어느 것을 인용할 것인지 추천하여 유저의 선택을 구하는 등, 선택지를 묻는 상호작용을 하는 경우에는 버튼식 선택UI 를 제공. 

---------------------------------

# [프로젝트 참여자 관리]

## [참여자 역할]
- **Owner**: 프로젝트 생성자로서 모든 권한을 보유하며, 참여자 관리 및 프로젝트 설정을 포함한 모든 기능을 사용할 수 있습니다. Owner 역할은 다른 사용자에게 양도 가능합니다.
- **Admin**: Owner와 유사한 권한을 가지지만, 프로젝트 삭제나 Owner 변경은 불가능합니다. 모든 콘텐츠 편집, 참여자 관리, AI Agent의 모든 모드 사용이 가능합니다.
- **Editor**: 문서 생성 및 편집, 파일 업로드, 프로젝트분석 수정이 가능합니다. AI Agent의 Ask, Write, Review 모드를 모두 사용할 수 있으나, 참여자 관리는 불가능합니다.
- **Commentator**: 모든 문서와 파일을 볼 수 있으며, 주석과 댓글을 추가할 수 있습니다. AI Agent의 Ask와 Review 모드만 사용 가능합니다.
- **Viewer**: 읽기 전용 권한으로, 모든 문서와 파일을 볼 수 있지만 수정이나 주석 추가는 불가능합니다. AI Agent의 Ask 모드만 활용 가능합니다.

## [협업 체계]
- **초대 및 수락 프로세스**: 프로젝트 참여 초대는 이메일을 통해 이루어지며, 초대받은 사용자는 수락 또는 거절할 수 있습니다. 유료 플랜의 경우 참여자 수에 제한이 있으며, 결제 상태에 따라 접근 권한이 조정됩니다.
- **알림 시스템**: 문서 수정, 댓글 추가, 파일 업로드 등 중요 이벤트 발생 시 관련 참여자에게 알림이 전송됩니다. 알림은 앱 내 알림과 이메일 알림으로 제공됩니다.
- **동시 편집**: Editor 이상의 권한을 가진 여러 참여자가 동일 문서를 동시에 편집할 수 있으며, 실시간으로 변경 사항이 공유됩니다.
- **변경 이력 관리**: 모든 문서 수정 내역은 저장되어 필요 시 이전 버전으로 되돌릴 수 있습니다. 변경 사항은 사용자별, 시간별로 추적 가능합니다.


# [프로젝트분석 상세]


## [AI 지원 기능]
- **정합성 검증**: AI Agent가 목표-주장-사실-자료 간의 논리적 정합성을 검증하고, 모순이나 불일치가 있을 경우 경고를 표시합니다.

- **사실 세분화 제안**: 포괄적이거나 추상적인 사실에 대해 보다 구체적인 하위 사실로 세분화할 것을 제안합니다.

- **중립성 검증**: 특히 '중립적 사실관계 분석'에서 주관적 해석이 포함되었는지 검토하고 객관성을 유지하도록 지원합니다.

- **연관 자료 추천**: 각 주장이나 사실과 관련된 프로젝트참고자료(ProjectReference)를 AI가 자동으로 추천합니다.  
