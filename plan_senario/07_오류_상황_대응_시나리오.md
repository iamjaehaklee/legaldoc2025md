# 오류 상황 대응 시나리오

## 시나리오 개요
법무법인의 변호사 정민석은 중요한 소송 준비를 위해 LegalEditor를 사용하고 있습니다. 작업 과정에서 다양한 오류 상황이 발생하지만, 시스템의 오류 대응 기능을 통해 작업을 계속 진행하고 데이터 손실을 방지하는 경험을 합니다.

## 용어 정의

### 목표(Goal)
법률 업무에서 목표는 다음 중 하나를 의미합니다:
1. 상대방으로부터 금전, 부동산 인도, 물건 명도, 권리 이전 등 구체적인 것을 얻어내는 것
2. 상대방의 금전, 인도, 권리 이전 등 소송상의, 소송외의 청구에 대해 방어하는 것
3. 상대방과 협상하여 유리한 조건의 계약/합의 체결을 달성하는 것
4. 법원/검찰/경찰/행정청/과세당국/중재원 등 법적판단기관으로부터 유리한 결정을 받는 것
5. 예상치 못한 과다한 조세 부과를 당하거나, 세무조사를 당하는 것을 예방하는 것
6. 장래에 불특정인으로부터 소송, 고소, 청구, 언론폭로 등을 당하거나, 수사기관/행정청/과세당국 등으로부터 조사를 당할 리스크를 예방하는 것

여기서 상대방은 민사인 경우 개인 또는 법인, 형사인 경우 수사기관(검찰, 경찰), 조세인 경우 과세관청, 행정처분/행정조사인 경우 행정청, 금융조사인 경우 금융감독원, 공정거래조사/처분인 경우 공정거래위원회 등임.

목표는 서로 중복되면 안 되며, 다른 목표들과 목적/수단 관계에 있어서도 안 됩니다. 목표는 궁극적으로 이루고자 하는 최종 결과물입니다.

### 주장(Claim)
주장은 목표를 달성하기 위한 구체적인 법적 논점이나 입장입니다. 각 주장은 하나 이상의 목표를 지원하며, 증거자료에 의해 뒷받침되어야 합니다. 오류 상황에서도 이러한 목표와 주장 관계는 보존되어야 합니다.

## 사용자 여정

### 1. 네트워크 연결 불안정 상황
- 정민석 변호사는 외부 미팅 장소에서 노트북으로 LegalEditor에 접속하여 "횡령 혐의 변호 전략" 프로젝트의 문서를 편집하고 있습니다.
- 프로젝트의 주 목표는 "무죄 판결 획득"으로 설정되어 있고, 핵심 주장으로는 "업무상 횡령에 해당하지 않는 정당한 업무 처리였음"이 설정되어 있습니다.
- 갑자기 카페의 Wi-Fi 연결이 불안정해지면서 화면 상단에 "네트워크 연결이 불안정합니다. 오프라인 모드로 전환합니다." 라는 알림이 표시됩니다.
- 오프라인 모드 배너가 표시되고, 현재 작업 중인 문서와 열람했던 증거자료들은 계속 접근 가능합니다.
- 설정된 목표와 주장 데이터도 오프라인 상태에서 완전히 접근 가능합니다.
- 정민석은 네트워크 연결 없이도 문서 편집을 계속 진행합니다.
- 편집 내용은 IndexedDB를 활용한 로컬 스토리지에 자동 저장됩니다.
- 30분 후 네트워크가 복구되자 "네트워크 연결이 복구되었습니다. 변경사항을 동기화합니다." 알림이 표시됩니다.
- 오프라인 상태에서 편집한 내용이 서버와 자동으로 동기화되며, 동기화 진행 상황이 프로그레스 바로 표시됩니다.

### 2. 대용량 파일 업로드 실패
- 증거자료로 150MB 크기의 고해상도 현장 사진 ZIP 파일을 업로드하려고 시도합니다.
- 업로드 진행 중 "파일 크기 제한 초과(최대 100MB)" 오류 메시지가 표시됩니다.
- 시스템은 해결 방법을 제안합니다: "1) 파일을 압축하여 크기 줄이기, 2) 여러 개의 작은 파일로 분할하여 업로드, 3) 파일 최적화 도구 사용"
- 정민석은 '파일 최적화 도구 사용' 옵션을 선택합니다.
- 시스템이 내장된 파일 최적화 도구를 실행하여 이미지 품질을 적절히 조정하면서 파일 크기를 줄입니다.
- 최적화된 80MB 파일이 생성되고, 이를 자동으로 업로드 시작합니다.
- 업로드가 성공적으로 완료되고 "파일 최적화 및 업로드 완료" 메시지가 표시됩니다.

### 3. 동시 편집 충돌
- 정민석은 팀원 김준호와 함께 같은 문서를 동시에 편집하고 있습니다.
- 두 사람이 우연히 문서의 같은 단락을 동시에 수정하려고 시도합니다.
- 더 심각하게, 김준호가 프로젝트 목표를 "무죄 판결 획득"에서 "집행유예 선고 획득"으로 변경하려 시도하는 동시에, 정민석은 관련 주장을 수정하고 있습니다.
- 시스템은 Operational Transformation 기술을 사용하여 충돌을 감지하고 관리합니다.
- 정민석이 변경 사항을 저장하려고 할 때, "편집 충돌 발생" 알림이 표시됩니다.
- 충돌 해결 인터페이스가 열리고, 두 버전의 차이점이 나란히 표시됩니다.
- 목표 변경과 주장 수정 사이의 관계도 분석되어 표시됩니다.
- 정민석은 자신의 변경 사항을 유지할지, 김준호의 변경 사항을 수용할지, 또는 두 변경 사항을 병합할지 선택할 수 있습니다.
- '병합하기' 옵션을 선택하고, 시스템은 두 변경 사항을 스마트하게 통합한 결과를 보여줍니다.
- 정민석이 병합된 내용을 확인하고 '확인' 버튼을 클릭하면, 병합된 버전이 저장되고 김준호에게도 업데이트된 내용이 실시간으로 표시됩니다.

### 4. OCR 처리 실패
- 정민석은 중요한 계약서 스캔본 PDF에 OCR 처리를 시도합니다.
- OCR 처리가 30% 진행된 상태에서 "OCR 엔진 오류: 처리에 실패했습니다." 메시지가 표시됩니다.
- 시스템은 여러 대안을 제시합니다: "1) 재시도, 2) 별도 OCR 서버 사용, 3) 수동 텍스트 입력"
- '재시도' 옵션을 선택했지만 다시 실패합니다.
- 이번에는 '별도 OCR 서버 사용' 옵션을 선택합니다.
- 시스템이 백업 OCR 서비스(Upstage AI 대신 Google Cloud Vision API)로 전환하여 처리를 재시도합니다.
- 처리 시간이 더 오래 걸리지만, 최종적으로 OCR이 성공적으로 완료됩니다.
- 성공 메시지와 함께 "성능 개선을 위해 오류 보고가 개발팀에 전송되었습니다" 알림이 표시됩니다.

### 5. AI 생성 오류
- 소장 초안 작성을 위해 AI 문서 생성 기능을 사용하려고 합니다.
- 'AI로 생성하기' 버튼을 클릭하고 설정된 목표와 주장을 기반으로 문서를 생성하도록 선택합니다.
- 처리 중 "OpenAI API 연결 오류: 요청 시간 초과" 메시지가 표시됩니다.
- 시스템은 "OpenAI 서비스에 일시적인 과부하가 발생했습니다. 잠시 후 다시 시도해주세요." 라고 안내합니다.
- '자동 재시도 알림 설정' 옵션을 제공하고, 정민석은 이를 활성화합니다.
- 다른 작업을 진행하던 중, 10분 후 "OpenAI 서비스가 정상화되었습니다. AI 생성을 계속하시겠습니까?" 알림이 표시됩니다.
- '계속하기' 버튼을 클릭하면 AI 생성 프로세스가 재개됩니다.
- 이번에는 AI 문서 생성이 성공적으로 완료되고, 설정된 목표와 주장을 반영한 결과 문서가 표시됩니다.

### 6. 저장 실패
- 정민석은 2시간 동안 작업한 문서를 저장하려고 '저장' 버튼을 클릭합니다.
- 갑작스러운 서버 오류로 "저장 실패: 서버 응답 없음" 오류 메시지가 표시됩니다.
- 시스템은 자동으로 로컬 백업을 생성하여 "작업 내용이 로컬에 임시 저장되었습니다." 메시지를 표시합니다.
- 동시에 "서버 연결 재시도 중..." 상태가 표시되고, 백그라운드에서 3회까지 자동 재시도가 이루어집니다.
- 3회 재시도 후에도 서버 연결이 복구되지 않으면, 시스템은 "로컬 복구 지점 생성 완료: 2023-03-25 15:30:45" 메시지를 표시합니다.
- 정민석은 로컬에 저장된 복구 지점 목록을 확인할 수 있으며, 서버 연결이 복구될 때까지 작업을 계속하거나 안전하게 로그아웃할 수 있습니다.
- 30분 후 서버 연결이 복구되자 "서버 연결이 복구되었습니다. 로컬 변경사항을 동기화하시겠습니까?" 메시지가 표시됩니다.
- '동기화' 버튼을 클릭하면 로컬에 저장된 변경사항이 서버에 성공적으로 업로드됩니다.

### 7. 브라우저 충돌
- 문서 작업 중 갑자기 브라우저가 충돌하여 탭이 강제 종료됩니다.
- 브라우저를 다시 열고 LegalEditor 사이트에 접속합니다.
- 로그인 후 즉시 "이전 세션이 비정상적으로 종료되었습니다. 복구하시겠습니까?" 메시지가 표시됩니다.
- '복구하기' 버튼을 클릭하면, 시스템은 자동 저장된 가장 최근 상태로 작업 환경을 복원합니다.
- 복원된 문서는 브라우저 충돌 직전 1분 이내의 상태로, 거의 모든 편집 내용이 보존되어 있습니다.
- 시스템은 "마지막 자동 저장 시점: 2023-03-25 16:12:30에서 복구되었습니다." 메시지를 표시합니다.
- 정민석은 중단된 지점부터 작업을 계속 진행할 수 있습니다.

### 8. 권한 오류
- 정민석은 동료가 공유한 "기업회계 분쟁" 프로젝트의 문서를 편집하려고 시도합니다.
- 편집 버튼을 클릭하자 "권한 오류: 이 문서에 대한 편집 권한이 없습니다." 메시지가 표시됩니다.
- 시스템은 다음과 같은 옵션을 제공합니다: "1) 읽기 전용으로 계속하기, 2) 편집 권한 요청하기, 3) 사본 만들기"
- '편집 권한 요청하기' 옵션을 선택합니다.
- 화면 하단에 프로젝트 관리자에게 보낼 메시지를 작성할 수 있는 인라인 폼이 나타납니다.
- "중요한 법적 검토를 위해 편집 권한이 필요합니다." 메시지를 입력하고 '요청 보내기' 버튼을 클릭합니다.
- "권한 요청이 성공적으로 전송되었습니다. 승인 시 알림을 받게 됩니다." 메시지가 표시됩니다.
- 읽기 전용 모드로 문서를 계속 검토하다가, 5분 후 "편집 권한이 승인되었습니다." 알림을 받습니다.
- 페이지를 새로고침하면 이제 문서 편집이 가능해집니다.

### 9. API 호출 한도 초과
- 국가법령정보센터 API를 통해 여러 법령을 연속적으로 검색하던 중, "API 호출 한도 초과: 분당 최대 요청 수 초과" 오류가 발생합니다.
- 시스템은 "현재 너무 많은 법령 검색 요청이 발생했습니다. 1분 후 자동으로 재시도합니다." 메시지를 표시합니다.
- API 호출 제한에 대한 정보와 함께 "캐시된 결과 보기" 옵션을 제공합니다.
- '캐시된 결과 보기'를 클릭하면, 이전에 검색했던 법령들의 캐시된 버전을 확인할 수 있습니다.
- 시스템은 백그라운드에서 API 요청 큐를 관리하면서, 제한이 해제되는 즉시 나머지 요청을 처리합니다.
- 1분 후 "API 제한이 해제되었습니다. 검색을 계속합니다." 메시지와 함께 나머지 법령 검색이 자동으로 완료됩니다.

### 10. 데이터베이스 동기화 오류
- 여러 장치 간에 작업을 전환하던 중, 정민석의 태블릿에서 "데이터베이스 동기화 오류: 버전 충돌" 메시지가 표시됩니다.
- 시스템은 "데스크톱에서 마지막으로 수정한 버전과 태블릿의 캐시된 버전 간에 충돌이 발생했습니다." 라고 설명합니다.
- 특히 충돌은 프로젝트의 목표와 주장 데이터에서 발생했으며, 데스크톱에서 새로운 주장이 추가된 반면 태블릿에서는 목표가 수정되었습니다.
- "서버 버전 사용" 또는 "로컬 버전 유지" 중 선택할 수 있는 옵션이 제공됩니다.
- 어떤 버전이 최신인지 확인하기 위해 '버전 비교' 버튼을 클릭합니다.
- 두 버전의 변경 사항이 나란히 표시되고, 타임스탬프와 함께 어떤 장치에서 변경되었는지 정보가 표시됩니다.
- 충돌 해결 인터페이스에서는 목표와 주장 간의 관계도 시각적으로 표시되어, 어떤 선택이 전체 프로젝트 구조에 미치는 영향을 확인할 수 있습니다.
- 서버 버전이 더 최신임을 확인하고 '서버 버전 사용'을 선택합니다.
- 시스템은 로컬 캐시를 업데이트하고 "데이터베이스가 성공적으로 동기화되었습니다." 메시지를 표시합니다.
- 이후 모든 장치에서 일관된 최신 상태의 데이터에 접근할 수 있게 됩니다.

## 시나리오 평가
본 시나리오를 통해 다음 요구사항들이 충족되는지 확인이 필요합니다:

1. 네트워크 연결 불안정 상황에서 오프라인 모드 전환 및 데이터 동기화가 원활한가?
2. 대용량 파일 업로드 실패 시 적절한 대안 제시 및 해결 방법이 효과적인가?
3. 동시 편집 충돌 발생 시 충돌 해결 인터페이스가 사용자 친화적인가?
4. OCR 처리 실패 시 대체 서비스로의 전환이 자동화되어 있는가?
5. AI 생성 오류 발생 시 재시도 메커니즘이 효과적으로 작동하는가?
6. 서버 저장 실패 시 로컬 백업 및 복구 기능이 데이터 손실을 방지하는가?
7. 브라우저 충돌 후 세션 복구 기능이 작업 연속성을 보장하는가?
8. 권한 오류 발생 시 대안 제시 및 권한 요청 프로세스가 직관적인가?
9. API 호출 한도 초과 시 캐싱 및 큐 관리 메커니즘이 효과적인가?
10. 데이터베이스 동기화 오류 시 버전 비교 및 충돌 해결 기능이 명확한가?
11. 오류 상황에서도 프로젝트의 목표와 주장 데이터가 적절히 보존되고 복구되는가? 