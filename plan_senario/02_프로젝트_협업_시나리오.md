# 프로젝트 협업 시나리오

## 시나리오 개요
중견 법률사무소 변호사 이수진은 복잡한 소송 사건을 맡게 되었습니다. 이 사건을 효율적으로 처리하기 위해 LegalEditor를 활용하여 법률 사무소 내 동료 변호사들 및 법률 조사원들과 협업하기로 결정했습니다.

[PASS]
프로젝트 협업 기능은 기본적으로 ProjectMembers 테이블과 관련 권한 구조를 통해 구현 가능합니다. Users, Projects, ProjectMembers 테이블이 데이터베이스 설계에 포함되어 있으며, 역할별 권한 관리가 가능합니다.

## 사용자 여정

### 1. 프로젝트 생성 및 팀원 초대
- 이수진 변호사는 유료 플랜을 구독 중인 LegalEditor 사용자로, 대시보드에서 '새 프로젝트' 버튼을 클릭합니다.
- "김상사 대 ABC기업 손해배상청구소송" 이라는 이름으로 프로젝트를 생성하고 자동으로 프로젝트 소유자(Owner) 권한을 부여받습니다.
- 프로젝트 생성 후, '팀원 관리' 탭을 클릭하여 초대 페이지로 이동합니다.
- 동료 변호사(박민우), 법률 조사원(김지원, 정다희), 법률 사무원(최재현)의 이메일 주소를 입력합니다.
- 각 팀원에게 적절한 권한을 할당합니다:
  - 박민우(유료 플랜 사용자): 관리자(Admin)
  - 김지원(유료 플랜 사용자): 편집자(Editor)
  - 정다희(무료 플랜 사용자): 주석자(Commentator)
  - 최재현(무료 플랜 사용자): 조회자(Viewer)
- 초대 메시지를 작성하고 '초대장 보내기' 버튼을 클릭합니다.
- 시스템이 자동으로 초대 받는 사용자의 플랜 상태를 확인하여 유료 플랜 사용자에게만 관리자/편집자 역할을 부여할 수 있음을 알리는 메시지가 표시됩니다.

[PASS]
프로젝트 생성과 멤버 초대 기능은 구현 가능합니다. 프로젝트 설정 UI(`ProjectSettingsTabViewComponent.tsx`) 내에 멤버 관리 섹션(`ProjectMemberManagementSectionComponent.tsx`)이 있으며, 초대 버튼(`InviteMemberButtonComponent.tsx`)과 모달(`InviteMemberModalComponent.tsx`)이 설계되어 있습니다. 역할에 따른 권한 제한과 유료/무료 플랜에 따른 제약도 `RolePlanRequirementComponent.tsx`를 통해 구현됩니다.

### 2. 팀원들의 프로젝트 참여
- 각 팀원은 이메일로 프로젝트 초대 링크를 받습니다.
- 팀원들은 초대 링크를 클릭하여 LegalEditor에 로그인(또는 가입)합니다.
- 로그인 후, 초대받은 프로젝트가 대시보드에 표시되며 '참여하기' 버튼을 클릭합니다.
- 시스템이 각 사용자의 플랜 상태를 확인하고, 유료 플랜 사용자는 할당된 역할로, 무료 플랜 사용자는 주석자 또는 조회자 역할로만 참여할 수 있음을 안내합니다.
- 정다희가 편집자 권한을 요청하자, 시스템은 "편집자 역할은 유료 플랜 사용자만 가능합니다. 업그레이드하시겠습니까?" 메시지를 표시합니다.

[TODO]
프로젝트 참여 흐름은 기본적으로 구현 가능하지만, 초대 링크를 통한 참여 프로세스와 플랜 상태에 따른 권한 제한 알림에 대한 구체적인 API 엔드포인트와 UI 컴포넌트가 명확하게 정의되어 있지 않습니다. 특히 프로젝트 초대 링크 생성 및 유효성 검증 로직, 그리고 플랜 상태 확인을 위한 API가 필요합니다. 또한 대시보드에 초대받은 프로젝트 표시 UI와 참여하기 버튼, 권한 요청 및 업그레이드 안내 메시지 UI 컴포넌트가 추가로 필요합니다.

### 3. 문서 구조 설정 및 업무 분담
- 이수진 변호사는 프로젝트 채팅방을 통해 팀 회의를 소집합니다.
- 채팅에서 손해배상청구소송을 위한 문서 구조와 증거자료 수집 계획을 논의합니다.
- '프로젝트분석' 탭에서 프로젝트 목표를 "손해배상액 5천만원 이상 판결 받기"로 설정합니다.
- 주장 항목으로 "계약 위반", "불법행위", "손해 인과관계" 세 가지를 추가합니다.
- 팀원별 업무를 분담합니다:
  - 박민우(관리자): 소장 초안 작성 및 AI 법률 추천 검토
  - 김지원(편집자): 판례 및 법령 조사, AI 근거자료 추천 활용
  - 정다희(주석자): 증거자료에 주석 달기 및 코멘트 제공
  - 최재현(조회자): 문서 검토 및 채팅을 통한 피드백 제공

[TODO]
채팅 기능은 ChatMessages 테이블을 통해 구현 가능하지만, 프로젝트 목표 및 주장 설정 기능은 01_신규사용자_시나리오.md와 마찬가지로 구체적인 데이터 모델(Goals, Claims 테이블)이 필요합니다. 또한 프로젝트 채팅방 UI와 목표/주장 설정 UI 컴포넌트가 명확하게 정의되어 있지 않습니다. 특히 AI 법률 추천 및 근거자료 추천 기능을 위한 API 엔드포인트와 UI 컴포넌트도 추가로 설계해야 합니다.

### 4. 증거자료 업로드 및 공유
- 정다희는 '증거자료' 탭에서 클라이언트로부터 받은 계약서, 이메일 교환 내역, 손해 증빙 자료 등을 업로드합니다.
- 각 증거자료에 태그와 설명을 추가하여 분류합니다.
- 주요 증거자료에 대해 PDF 뷰어에서 중요 부분에 하이라이트와 주석을 추가합니다.
- 채팅방에 "증거자료 업로드 완료, 특히 [인용: 손해산정표.pdf] 문서를 확인해주세요"라는 메시지를 보냅니다.

[PASS]
증거자료 업로드와 태그 추가 기능은 Evidence 테이블과 ProjectTags 테이블을 통해 구현 가능합니다. EvidenceAnnotations 테이블을 통해 PDF에 주석을 추가할 수 있으며, ChatMessages 테이블을 통해 메시지를 보낼 수 있습니다. 다만, PDF 뷰어 컴포넌트와 증거자료 인용 기능의 구체적인 UI 설계가 필요합니다.

### 5. 실시간 문서 협업
- 박민우는 소장 초안 문서를 생성하고 Plate.js 에디터에서 작성을 시작합니다.
- 이수진은 동시에 같은 문서에 접속하여 박민우의 작업을 실시간으로 확인합니다.
- 두 사람이 동시에 서로 다른 섹션을 편집하며, 커서 위치가 컬러로 구분되어 표시됩니다.
- 박민우가 문서에 "계약 위반 사항" 섹션을 작성하는 동안, 이수진은 "청구취지" 섹션을 작성합니다.

[TODO]
실시간 문서 협업 기능이 데이터베이스 구조에 명확하게 정의되어 있지 않습니다. 실시간 협업을 위해서는 Supabase Realtime 기능을 활용해야 하지만, 이에 대한 구체적인 구현 방식과 문서 동시 편집 시 충돌 해결 메커니즘이 설계되어 있지 않습니다. 또한 Plate.js 에디터의 실시간 협업 기능과 커서 위치 표시 등의 UI 컴포넌트도 추가로 설계해야 합니다.

### 6. AI 문서 생성 및 협업 검토
- 김지원은 법령 검색 탭에서 관련 법령과 판례를 검색하여 문서에 인용할 내용을 찾습니다.
- "민법 제750조", "대법원 2018다12345 판결" 등을 검색하여 관련 내용을 확인합니다.
- 찾은 법령과 판례를 채팅방에 공유하고, 소장 문서에 인용할 것을 제안합니다.
- 박민우는 AI 문서 부분 생성 기능을 활용하여 법적 논리 전개 부분을 생성해달라고 요청합니다.
- 생성된 내용을 팀원들과 함께 검토하고, 필요한 부분을 수정합니다.

[TODO]
법령 및 판례 검색 기능과 AI 문서 생성 기능이 데이터베이스 구조와 API에 명확하게 정의되어 있지 않습니다. 법령과 판례 데이터를 저장하는 테이블(Laws, Precedents 등)과 법령 검색 및 AI 문서 생성을 위한 API 엔드포인트가 필요합니다. 또한 이러한 기능을 제공하는 UI 컴포넌트도 추가로 설계해야 합니다.

### 7. 프로젝트분석 활용
- 이수진은 '프로젝트분석' 탭에서 설정한 목표와 주장에 대해 AI의 분석 결과를 확인합니다.
- AI가 추천한 추가 근거자료와 보완이 필요한 주장 항목을 검토합니다.
- "상대방 입장 분석" 기능을 통해 피고 측의 예상 대응 전략을 확인합니다.
- 팀 회의를 통해 분석 결과를 공유하고, 소장 내용 보완 방향을 논의합니다.

[TODO]
프로젝트 분석 기능과 AI 기반 추천 및 상대방 입장 분석 기능이 데이터베이스 구조와 API에 명확하게 정의되어 있지 않습니다. 목표와 주장 데이터를 저장하는 테이블(Goals, Claims)과 AI 분석 결과를 저장하고 검색하는 API 엔드포인트가 필요합니다. 또한 이러한 기능을 제공하는 UI 컴포넌트와 상대방 입장 분석 알고리즘 등도 추가로 설계해야 합니다.

### 8. 최종 문서 검토 및 완성
- 최재현은 뷰어 권한으로 작성된 소장을 검토하고, 채팅방을 통해 오타와 형식적 문제점을 피드백합니다.
- 이수진은 최종 검토 후 필요한 수정사항을 반영합니다.
- 완성된 소장을 PDF로 내보내기하여 모든 팀원과 공유합니다.
- 문서 상태를 '진행 중'에서 '검토 완료'로 변경합니다.

[TODO]
문서 검토 및 내보내기 기능이 API에 명확하게 정의되어 있지 않습니다. 문서 상태 변경은 Documents 테이블의 `status` 필드를 통해 가능하지만, PDF 내보내기 기능과 팀 전체 공유 기능을 위한 API 엔드포인트가 필요합니다. 또한 문서 상태 변경 및 내보내기를 위한 UI 컴포넌트도 추가로 설계해야 합니다.

## 시나리오 평가
본 시나리오를 통해 다음 요구사항들이 충족되는지 확인이 필요합니다:

1. 프로젝트 내 팀원 초대 및 권한 관리가 원활한가?
2. 실시간 문서 협업이 효과적으로 이루어지는가?
3. 증거자료 공유 및 주석 기능이 팀 협업에 도움이 되는가?
4. 채팅 기능을 통한 커뮤니케이션이 효율적인가?
5. 프로젝트분석 기능이 실제 법률 업무에 유용한 인사이트를 제공하는가?
6. 권한별로 적절한 기능 제한이 이루어지는가?
7. AI 문서 생성 기능이 팀 협업 과정에서 유용하게 활용되는가?

[TODO]
전체적으로 이 시나리오를 완전히 구현하기 위해서는 다음과 같은 보완이 필요합니다:
1. 초대 링크 생성 및 유효성 검증 메커니즘
2. 실시간 문서 협업 및 충돌 해결 기능
3. 목표/주장 관리를 위한 데이터 모델 및 UI 컴포넌트
4. 법령/판례 검색 및 인용을 위한 데이터 모델 및 UI 컴포넌트
5. AI 문서 생성 및 프로젝트 분석 기능
6. 문서 내보내기 및 공유 메커니즘

위 항목들이 보완되면 시나리오의 모든 요구사항을 충족할 수 있을 것입니다. 