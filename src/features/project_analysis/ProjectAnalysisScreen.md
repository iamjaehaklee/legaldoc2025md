# LegalEditor  프로젝트분석스크린 (`ProjectAnalysisScreen.tsx`)

## 1. 프로젝트분석스크린 개요

- 프로젝트분석스크린은 법률 프로젝트의 전략적 분석을 지원하며, **우리측 입장 분석 스크린** (`OurSideAnalysisScreen.tsx`), **상대방측 입장 분석 스크린** (`OpponentSideAnalysisScreen.tsx`)(상대방이 여럿인 경우, 여럿에 대한 각각의 서브탭스크린 생성), **중립적 분석 스크린** (`NeutralAnalysisScreen.tsx`)이라는 3가지 서브탭스크린으로 구성됩니다. 
- AI Agent와 상호작용하여 수정 및 피드백을 받을 수 있도록 설계됩니다.
- **프로젝트분석스크린** 화면 구조는 다음과 같음(위의 상단 및 하단이 이어져서 유저가 스크롤해서 내려 볼 수 있음).
      - **프로젝트분석스크린툴바**(`ProjectAnalysisScreenToolbarComponent.tsx`) 
            - **프로젝트분석스크린칩필터** : 2개 이상의 검색어를 넣을 수 있는 Chip 필터 컴포넌트(아래의 **트리 구조 컴포넌트** 및 **분석 메인 내용 컴포넌트**에 대한 필터 적용) (`ProjectAnalysisScreenChipFilterComponent.tsx`) 
            - 새 요소 추가 아이콘버튼(+) : 누를 경우 **새항목입력인터페이스** (`NewItemInputInterfaceComponent.tsx`) 입력창으로 입력
      - **트리 구조 컴포넌트**(`TreeRelationshipComponent.tsx`)
            - **좌측 Sidebar**(`ProjectLeftSidebarComponent.tsx`)에서 **프로젝트참고자료(ProjectReference)**를 **트리 구조 컴포넌트**의 **주장**이나, **사실**에 드래그&드롭하는 경우, 해당 트리 요소로 추가(단, 해당 트리 구조 하에 위치할 수 있는 종류의 자료여야 함. 아래 트리 구조 개념 참고). 
      - **분석 메인 내용 컴포넌트** (`AnalysisMainComponent.tsx`)
            - **좌측 Sidebar**(`ProjectLeftSidebarComponent.tsx`)에서 **프로젝트참고자료(ProjectReference)**를 **트리 구조 컴포넌트**의 **주장**이나, **사실**에 드래그&드롭하는 경우, 해당 트리 요소로 추가(단, 해당 트리 구조 하에 위치할 수 있는 종류의 자료여야 함. 아래 트리 구조 개념 참고). 


## 2. 개념 정의 
- 상대방, 목표, 주장, 사실, 자료의 정의 : [ProjectOverview.md] 참조.
- **우리측 입장 분석**, **상대방측 입장 분석**, **중립적 사실관계 분석** : [ProjectCoreConcept.md] 참조.


## 3. **우리측 입장 분석** 서브탭스크린의 UI

### 3.1.**프로젝트분석스크린툴바**(`ProjectAnalysisScreenToolbarComponent.tsx`) 

  - **프로젝트분석스크린칩필터** : 2개 이상의 검색어를 넣을 수 있는 Chip 필터 컴포넌트(아래의 **트리 구조 컴포넌트** 및 **분석 메인 내용 컴포넌트**에 대한 필터 적용) 

  - [새 요소 추가 아이콘버튼(+)] : 목표/주장/사실/각 자료들을 추가하는 버튼. 누를 경우 아래의 **새항목입력인터페이스** (`NewItemInputInterfaceComponent.tsx`)입력창으로 입력

  - **새항목입력인터페이스** (`NewItemInputInterfaceComponent.tsx`)
      - [1] 텍스트 입력 필드 (플레이스홀더: "목표/주장/사실관계를 입력하세요...") 및 목표/주장/사실관계 스위치. [2] 드래그&드롭으로 프로젝트참고자료(ProjectReference)를 추가할 수 있음(이렇게 프로젝트참고자료를 추가한 경우에는 목표/주장/사실관계 스위치는 비활성화). [3] 그 하단에는 **새항목후보분석결과** 컴포넌트(`NewItemCandidateAnalysisResultComponent.tsx`). 
      - 입력한 내용이 텍스트인 경우, 목표/주장/사실 중 어느 것인지 AI가 검토하여, **새항목후보분석결과** 컴포넌트(`NewItemCandidateAnalysisResultComponent.tsx`). 에 구별 결과 및 그 이유를 안내해 주고, 해당 항목(목표/주장/사실 중 하나)으로 스위치를 자동 설정. 단, 최종적으로 목표/주장/사실 중 어느 것이라고 보아 입력할 것인지는 유저의 선택임. 
      - 유저가 텍스트 입력을 하면, 텍스트 입력 필드 아래에 **새항목후보분석결과** 컴포넌트(`NewItemCandidateAnalysisResultComponent.tsx`)가 보여짐.
          - 입력을 하고 텍스트 입력 필드 옆의 "분석하기" 버튼을 누르면, 실시간으로 AI가 파악한, 새로운 입력 항목(들)의, (기존 항목과의 관계 또는 새로운 항목들 상호간의 관계)에 대한, 트리구조를 텍스트 입력창 하단에 보여 주고(이것은 어느 트리구조 항목 하에 새 항목을 삽입할 것인지 결저하게 하기 위함임), 유저가 그 트리 구조상의 드래그&드롭으로 최종 정리(예)하거나, 입력 텍스트를 수정할 기회를 주고, 입력을 확정할 것인지 선택하게 할 것. 
          - 입력한 내용이 목표/주장/사실 중 어느 것인지에 따라, 분석 결과 점수를 미리 보여 줌. 분석 결과 점수의 구체적인 내용은 아래의  **분석 메인 내용 컴포넌트** (`AnalysisMainComponent.tsx`)에서의 분석 방법에 따름.
          - 이 새 항목에 대하여, **상대방측 입장 분석**에서 제기할 것으로 예상되는 목표/주장/사실/자료들도 지적함. 그리고, "상대방 입장의 목표/주장/사실/자료도 함께 추가하시겠습니까?"라는 체크박스로 선택하게 함.
          - 이 새 항목에 대하여 **중립적 관점 분석** 에서 추가할 만한 사항이 있다면(사실/자료) 그러한 사실/자료임을 지적함. 그리고, "중립적 관점 분석에 위의 사실/자료도 함께 추가하시겠습니까?"라는 체크박스로 선택하게 함.
          - 유저가 최종적으로 "새로운 목표/주장/사실 생성하기" 버튼을 누르면, 그 항목이 생성됨.(상대방 입장의 )
          - 유저가 입력한 내용이, 1개의 목표/주장/사실일 수도 있으나, 여러 개의 목표/주장/사실일 수도 있음. 여러 개의 목표/주장/사실인 경우, 그렇게 파악되었음 및 그 파악 이유를 유저에게 알려 주고, 각각 분할된 항목별로 순차 입력창을 다시 띄우는 것에 대해 유저가 승인하면, 각각 분할된 항목별로 순차 입력창을 다시 띄움. 
              - 예를 들어 : 유저가 입력한 내용을 분석해 보니, "목표"가 1개, "주장"이 2개라면, [1] 그 분석 사실을 유저에게 알려 주면서, "위 목표 1개, 주장 2개를 순차 입력 하시겠습니까?"라고 물어서, "예"라고 하면, [2-1] "입력 대상 (1/3)"이라는 표시와 함께, 위의 첫 번째 "목표" 내용이 입력된 채로 **새항목입력인터페이스** (`NewItemInputInterfaceComponent.tsx`)가 보여짐. 입력 또는 취소하여 마치면, [2-2] "입력 대상 (2/3)"이라는 표시와 함께, 위의 2번째 "주장" 내용이 입력된 채로 **새항목입력인터페이스** (`NewItemInputInterfaceComponent.tsx`)가 보여짐. 입력 또는 취소하여 마치면, [2-3] "입력 대상 (3/3)"이라는 표시와 함께, 위의 3번째 "주장" 내용이 입력된 채로 **새항목입력인터페이스** (`NewItemInputInterfaceComponent.tsx`)가 보여짐. 입력 또는 취소하여 마치면, 최종 종료.    
 


### 3.2 **트리 구조 컴포넌트** (`TreeRelationshipComponent.tsx`): 목표-주장-사실 등 계층적 관계 및 시각화

  ```
  목표(Goal)
  └── 주장(Claim)
      ├── 사실(Fact, Level 1)
      │   ├── 하위사실(SubFact, Level 2)
      │   │   └── 상세사실(DetailedFact, Level 3)
      │   ├── 증거자료(Evidence)
      │   └── 주장서류(ClaimingDocument)
      ├── 법령(Law)
      ├── 판례(Precedent)
      ├── 프로젝트최종결정문(ProjectFinalJudgement)
      └── 참고자료(ConsiderableDocument)
  ```
  - 위의 **트리 구조**를 **목표(Goal)**별로 트리구조 계층적 관계를 보여 주는 것. 
  - 그런데, 위 트리 구조 중 어느 것이든 한 항목을 선택하여 그것을 기준으로 계층적 관계를 간소하게 볼 수 있음. 
  - 즉, 선택된 항목 이상의 노드는 모두 닫고, 선택된 항목과 수평적 또는 이하의 노드는 펼쳐서 보이기.  
  - 2개 이상의 항목을 선택할 수 있음. 이 컴포넌트 상단에 Chip 필터링 컴포넌트(`GoalClaimFactRelationshipFilterChipComponent.tsx`)로 필터링. 
  - 취약 지점 하이라이트 (증거자료가 부족한 사실, 사실의 뒷받침이 부족한 주장 등)
  - "사실"은 최대 3단계까지의 계층 구조 허용 (Level 1 ~ Level 3)
      - Level 1: 사실
      - Level 2: 하위사실
      - Level 3: 상세사실

### 3.3. **분석 메인 내용 컴포넌트** (`AnalysisMainComponent.tsx`)
  
  - **목표(Goal) 달성 가능성 평가** (`GoalAnalysisComponent.tsx`):
      - 목표 유형별 달성 난이도 기초 점수 산정 (통계 데이터 기반)
      - 하위 **주장**의 설득력, 구체성, 충분성, 상호모순, 중복 여부, 목표 정합성을 검토하여 달성 가능성 조정 [정합성 점수 표시 (예: "목표-주장 정합성: 85%")]
      - **사실(Fact)**, **증거자료(Evidence)**, **주장서류(ClaimingDocument)**, **법령(Law)**, **판례(Precedent)**, **프로젝트최종결정문(ProjectFinalJudgement)**, **참고자료(ConsiderableDocument)**의 신뢰성에 따른 가능성 점수 조정
      - 목표 간 상호작용이 달성 가능성에 미치는 영향 분석
      - 위 사항들을 고려해서, **목표 분석 스코어보드**  (`GoalAnalysisScoreboardComponent.tsx`)
      - **목표 분석 텍스트 컴포넌트**(`GoalAnalysisTextComponent.tsx`)
          - 위 요소들에 대한 분석 결과 텍스트
              - 예 : "재정신청 절차에서 기소 결정을 구하는 것인 점 및 이 프로젝트의 자료를 검토해 볼 때 .... 요소들을 검토하면 목표 달성 가능성이 매우 낮음."
              - 예 : "... 목표와 ... 목표는 ...라는 점에서 목적/수단 관계에 있어 보임."
              - 예 : "목표 달성을 위한 주장 중 .... 과 .... 이 상호 모순됨. 그 이유는 ...."
          - 목표 달성 가능성 개선 전략 제안 
              - 목표 조정/정교화 제안
              - 추가로 필요한 **주장**을 제시 (프로젝트데이터를 고려하여 제기가 가능하면서도 목표 달성에 효과적인 주장으로 제시)
              - 목표 사이에, 전략적 우선순위 재조정 가이드
      - **목표 개선사항 선택 컴포넌트**(`GoalEnhancementSelectionComponent.tsx`)
          - 위 개선 방안들을 유저가 체크박스로 선택하고, 그 체크박스의 내용대로 AI Agent 가 Write mode 로 수정하는 버튼 및 기능 제공.

  - **주장(Claim) 설득력 및 목표기여도 평가** (`ClaimAnalysisComponent.tsx`):
      - 법리적 타당성 평가 (**법령**/**판례** 기반)
      - 논리적 일관성 및 완결성 평가
      - **사실(Fact)**, **증거자료(Evidence)**, **주장서류(ClaimingDocument)** 기반 설득력 강도 평가
      - 상대방의 반대 **주장(Claim)**, **사실(Fact)**, **증거자료(Evidence)**, **주장서류(ClaimingDocument)** , **법령(Law)**, **판례(Precedent)**, **프로젝트최종결정문(ProjectFinalJudgement)**, **참고자료(ConsiderableDocument)** 에 대한 방어력 평가
      - 즉, 위의 내용들을 반영한, 주장별 설득력/논리성/일관성/목표기여도 스코어보드 [설득력 점수 표시 (예: "주장 설득력: 72%")](`ClaimAnalysisScoreboardComponent.tsx`)
      - **주장 분석 텍스트 컴포넌트**(`ClaimAnalysisTextComponent.tsx`)
          - 위 요소들에 대한 분석 결과 텍스트
              - 예 : "이 주장의 목표가 손해배상 5,000만원 이상에 대한 인용 판결을 받는 것인데, 이 주장은 30만원의 손해를 주장하는 것에 불과하여 목표 달성에 효과적이지 않음."
              - 예 : "... 주장과 이 주장은 ...라는 점에서 서로 중복된 것으로 보임."
              - 예 : "이 주장 중 .... 주장은 상호 모순됨. 그 이유는 ...."
          - 주장 개선 전략 제안 
              - 법리적, 논리적, 구체성 강화 포인트 제시 [구체화 제안 (예: "이 주장은 시간/장소/행위 정보 추가 필요")] [주장 재구성 제안 (예: "이 두 주장은 하나로 통합하는 것이 효과적")]
              - 추가가 필요한 **사실(Fact)**, **증거자료(Evidence)**, **주장서류(ClaimingDocument)** , **법령(Law)**, **판례(Precedent)**, **프로젝트최종결정문(ProjectFinalJudgement)**, **참고자료(ConsiderableDocument)** 제시 (현재 입수되지 않은 것이라면, 입수해야 할 것들도 제시) [(예: "민법 제750조를 추가 근거로 활용하세요")] [(예: "이 주장은 대법원 판례 XXX로 보강 필요")] [(예: "전문가 의견을 추가하여 주장 A를 강화하세요")]
              - 리스크 [리스크 수준 표시 (예: "주장 리스크: 높음/중간/낮음") 및 리스크의 이유]
              - 핵심 반론 대응 전략 
              - 주장 사이에, 전략적 우선순위 재조정 가이드
              - 주장 설득력/논리성/일관성/목표기여도 강화 전략 제안
          - **주장 개선사항 선택 컴포넌트**(`ClaimEnhancementSelectionComponent.tsx`)
              - 위 개선 방안들을 유저가 체크박스로 선택하고, 그 체크박스의 내용대로 AI Agent 가 Write mode 로 수정하는 버튼 및 기능 제공.
  
    - **사실(Fact) 신뢰성 및 주장기여도 평가(사실의 하위사실인 경우 상위사실에 대한 신뢰기여도 포함)** (`FactAnalysisComponent.tsx`):
        - 하위 **사실(Fact)**, **증거자료(Evidence)**, **주장서류(ClaimingDocument)** 기반 신뢰성 강도 평가
        - 즉, 위 내용을 반영한, 사실별 신뢰성/구체성(6하원칙 충족도 포함)/가치중립성/주장에대한기여도에 대한 **사실 분석 스코어보드** [6하원칙 충족도 표시 (예: "6하원칙 충족도: 68%")](`FactAnalysisScoreboardComponent.tsx`) 
        - **사실 분석 텍스트 컴포넌트**(`FactAnalysisTextComponent.tsx`)
            - 신뢰성/구체성(6하원칙 충족도 포함)/가치중립성/주장에대한기여도에 대한 분석 결과 텍스트
                - 예 : 기존 사실관계와의 관계 분석 (중복, 포함, 모순 등)
            - 신뢰성/구체성(6하원칙 충족도 포함)/가치중립성/주장에대한기여도에 대한 개선 방안 제시
                - 예 : 가치판단이 포함된 경우 중립적 표현 제안 
                - 예 : 논리성/구체성(대상 **사실**의 내용 구체성 보강 방안 제시, 또는 추가할 만한 더 구체적인 하위 Fact 제시) 강화 포인트
        - **사실 개선사항 선택 컴포넌트**(`FactEnhancementSelectionComponent.tsx`)
            - 개선 방안들을 유저가 체크박스로 선택하고, 그 체크박스의 내용대로 AI Agent 가 Write mode 로 수정하는 버튼 및 기능 제공.
        
    - **증거자료(Evidence)자체의신뢰성 및 상위사실에신뢰성기여도 종합 평가**(`EvidenceAnalysisComponent.tsx`):
        - 해당 증거자료의 작성자/내용/작성시기/형식에 입각한 증거자료 자체의 신뢰성 점수 표시(증거자료자체의신뢰성).
        - 상위 주장과의 관계에서, 해당 증거자료가 주장을 뒷받침하는 데에 얼마나 효과적으로 기여하는지 주장별로 점수를 표시(상위사실에대한신뢰성기여도).
        - 즉, 위의 2가지 내용을 반영한, 증거자료별 신뢰성/구체성/가치중립성/상위사실에대한신뢰성기여도 스코어보드 (`EvidenceAnalysisScoreboardComponent.tsx`)
        - **증거자료 분석 텍스트 컴포넌트**(`EvidenceAnalysisTextComponent.tsx`)
            - 신뢰성/구체성(6하원칙 충족도 포함)/가치중립성/주장에대한기여도에 대한 분석 결과 텍스트
                - 예 : 기존 사실관계와의 관계 분석 (중복, 포함, 모순 등)
            - 신뢰성/구체성(6하원칙 충족도 포함)/가치중립성/주장에대한기여도에 대한 개선 방안 제시
                - 예 : 가치판단이 포함된 경우 중립적 표현 제안 
                - 예 : 논리성/구체성(대상 **사실**의 내용 구체성 보강 방안 제시, 또는 추가할 만한 더 구체적인 하위 Fact 제시) 강화 포인트
        - **증거자료 개선사항 선택 컴포넌트**(`EvidenceEnhancementSelectionComponent.tsx`)
            - 개선 방안들을 유저가 체크박스로 선택하고, 그 체크박스의 내용대로 AI Agent 가 Write mode 로 수정하는 버튼 및 기능 제공.
          
    - **법령(Law)의 주장기여도 종합 평가**(`LawAnalysisComponent.tsx`):
        - 상위 주장과의 관계에서, 해당 법령이 상위 주장을 뒷받침하는 데에 얼마나 효과적으로 기여하는지 점수를 표시(주장기여도).
        - 법령의 주장기여도 스코어보드 (`LawAnalysisScoreboardComponent.tsx`)
        - **법령 분석 텍스트 컴포넌트**(`LawAnalysisTextComponent.tsx`)
            - 위의 해당 법령이 상위 주장을 뒷받침하는 데에 얼마나 효과적으로 기여하는지를 판단한 근거 및 결론. 
            - 추가적으로 인용되어야 하는 법령 조항이 있는지 검색해서 제시. 
        - **법령 개선사항 선택 컴포넌트**(`LawEnhancementSelectionComponent.tsx`)
            - 개선 방안들을 유저가 체크박스로 선택하고, 그 체크박스의 내용대로 AI Agent 가 Write mode 로 수정하는 버튼 및 기능 제공.
        

    - **판례(Precedent)의 주장기여도 종합 평가**(`PrecedentAnalysisComponent.tsx`):
        - 상위 주장과의 관계에서, 해당 판례가 상위 주장을 뒷받침하는 데에 얼마나 효과적으로 기여하는지 점수를 표시(주장기여도).
        - 판례의 주장기여도 스코어보드 (`PrecedentAnalysisScoreboardComponent.tsx`)
        - **판례 분석 텍스트 컴포넌트**(`PrecedentAnalysisTextComponent.tsx`)
            - 위의 해당 판례가 상위 주장을 뒷받침하는 데에 얼마나 효과적으로 기여하는지를 판단한 근거 및 결론. 
            - 특히, 판례의 기초사실이, 주장 내용과 얼마나 부합하는지, 그 기초사실과 판시사항을 이 주장에 적용할 수 있는지 검토.
            - 추가적으로 인용되어야 하는 판례가 있는지 검색해서 제시. 
        - **판례 개선사항 선택 컴포넌트**(`PrecedentEnhancementSelectionComponent.tsx`)
            - 개선 방안들을 유저가 체크박스로 선택하고, 그 체크박스의 내용대로 AI Agent 가 Write mode 로 수정하는 버튼 및 기능 제공.
      
    - **참고자료(ConsiderableDocument)의 신뢰성 및 주장기여도 종합 평가**(`ConsiderableDocumentAnalysisComponent.tsx`):
        - 상위 주장과의 관계에서, 해당 참고자료가 상위 주장을 뒷받침하는 데에 얼마나 효과적으로 기여하는지 점수를 표시(주장기여도).
        - 또한, 위 참고자료의 작성자, 작성기관, 작성시기, 내용을 고려할 때 참고자료 자체의 신뢰성이 얼마나 되는지 검토(참고자료자체의신뢰성). 
        - 위 사항을 고려한, 참고자료의 주장기여도 스코어보드 (`ConsiderableDocumentAnalysisScoreboardComponent.tsx`)
        - **참고자료 분석 텍스트 컴포넌트**(`ConsiderableDocumentAnalysisTextComponent.tsx`)
            - 위의 해당 참고자료가 상위 주장을 뒷받침하는 데에 얼마나 효과적으로 기여하는지를 판단한 근거 및 결론. 
            - 참고자료의 작성자, 작성기관, 작성시기, 내용을 고려한 신뢰성 분석 결과.
            - 추가적으로 인용되어야 하는 참고자료가 있는지 검색해서 제시. 
        - **참고자료 개선사항 선택 컴포넌트**(`ConsiderableDocumentEnhancementSelectionComponent.tsx`)
            - 개선 방안들을 유저가 체크박스로 선택하고, 그 체크박스의 내용대로 AI Agent 가 Write mode 로 수정하는 버튼 및 기능 제공.
    
    - **프로젝트최종결정문(ProjectFinalJudgement)의 주장기여도 종합 평가**(`ProjectFinalJudgementAnalysisComponent.tsx`):
        - 프로젝트최종결정문(ProjectFinalJudgement)은 그 자체로 심층 분석의 대상임. 이러한 분석 내용을 제시(`ProjectFinalJudgementDeepAnalysisComponent.tsx`)
            - 우리측 목표를 달성시킨 것이고, 우리측 주장도 받아들인 것이면, 상급심이나 다른 분쟁에서 그 목표 달성 또는 인정된 주장을 유지할 수 있을 것인지 분석되어야 함. => 그래서 우리 측의 후속 보강 포인트 및 해당 보강 포인트의 효과성, 가능성도 분석되어야 함. 
            - 우리측 목표를 좌절시킨 것이고, 우리측 주장도 배척한 것이면, 상급심이나 다른 분쟁에서 위 프로젝트최종결정문의 내용을 뒤집을 수 있을 것인지 분석되어야 함. => 그래서 우리 측의 반론 포인트 및 해당 반론 포인트의 효과성, 가능성도 분석되어야 함. 
        - 위 관점을 포함,프로젝트최종결정문(ProjectFinalJudgement)이 상위 주장과의 관계에서,상위 주장을 뒷받침하는 데에 얼마나 효과적으로 기여하는지 점수를 표시(주장기여도).
        - 위 사항을 고려한, 프로젝트최종결정문(ProjectFinalJudgement)의 주장기여도 스코어보드 (`ProjectFinalJudgementAnalysisScoreboardComponent.tsx`)
        - **프로젝트최종결정문 분석 텍스트 컴포넌트**(`ProjectFinalJudgementAnalysisTextComponent.tsx`)
            - 위의 해당 프로젝트최종결정문이 상위 주장을 뒷받침하는 데에 얼마나 효과적으로 기여하는지를 판단한 근거 및 결론. 
            - 프로젝트최종결정문의 심층 분석 결과:
                - 우리측 목표를 달성시킨 것이고, 우리측 주장도 받아들인 것이면, 상급심이나 다른 분쟁에서 그 목표 달성 또는 인정된 주장을 유지할 수 있을 것인지 분석.
                - 우리측 목표를 좌절시킨 것이고, 우리측 주장도 배척한 것이면, 상급심이나 다른 분쟁에서 위 프로젝트최종결정문의 내용을 뒤집을 수 있을 것인지 분석.
            - 상위 주장을 뒷받침하기 위해 추가적으로 제시되어야 하는 이 프로젝트 내의 다른 자료가 있는지 검색해서 제시.   
        - **프로젝트최종결정문 개선사항 선택 컴포넌트**(`ProjectFinalJudgementEnhancementSelectionComponent.tsx`)
            - 개선 방안들을 유저가 체크박스로 선택하고, 그 체크박스의 내용대로 AI Agent 가 Write mode 로 수정하는 버튼 및 기능 제공.

    - **주장서류(ClaimingDocument)의 주장기여도 종합 평가**(`ClaimingDocumentAnalysisComponent.tsx`):
        - 주장서류(ClaimingDocument)은 그 자체로 심층 분석의 대상임. 이러한 분석 내용을 제시(`ClaimingDocumentDeepAnalysisComponent.tsx`)
            - 우리측 주장서류이면, 그 주장서류의 일관성, 논리성은 물론, 그 주장서류가 인용한 법령, 판례, 참고자료 등까지 분석되어야 함.[위에서 본 트리구조로, 해당 주장서면에 대해 분석] => 그래서 우리 측의 후속 보강 포인트 및 해당 보강 포인트의 효과성, 가능성도 분석되어야 함. 
            - 상대측 주장서류 또한, 그 주장서류의 일관성, 논리성은 물론, 그 주장서류가 인용한 법령, 판례, 참고자료 등까지 분석되어야 함.[위에서 본 트리구조로, 해당 주장서면에 대해 분석] => 그래서 우리 측의 반론 포인트 및 해당 반론 포인트의 효과성, 가능성도 분석되어야 함. 
        - 위 관점을 포함, 주장서류(ClaimingDocument)가 상위 주장과의 관계에서,상위 주장을 뒷받침하는 데에 얼마나 효과적으로 기여하는지 점수를 표시(주장기여도).
        - 위 사항을 고려한, 주장서류(ClaimingDocument)의 주장기여도 스코어보드 (`ClaimingDocumentAnalysisScoreboardComponent.tsx`)
        - **주장서류 분석 텍스트 컴포넌트**(`ClaimingDocumentAnalysisTextComponent.tsx`)
            - 위의 해당 주장서류가 상위 주장을 뒷받침하는 데에 얼마나 효과적으로 기여하는지를 판단한 근거 및 결론. 
            - 주장서류의 심층 분석 결과:
                - 우리측 주장서류의 경우, 일관성, 논리성 및 인용된 법령, 판례, 참고자료에 대한 분석 결과.
                - 상대측 주장서류의 경우, 일관성, 논리성 및 인용된 법령, 판례, 참고자료에 대한 분석 결과.
            - 상위 주장을 뒷받침하기 위해 추가적으로 제시되어야 하는 이 프로젝트 내의 다른 주장서류가 있는지 검색해서 제시.   
            - 예시 분석:
                - 상대방 주장서류(ClaimingDocument)인 '준비서면'에서, 상대방이 우리 주장에 부합하는 취지로 '자인'하는 경우가 있는데, 그 경우에는 우리 주장에 부합하는 자료로 인용되어야 함. 
                - 상대방 주장서류(ClaimingDocument)인 '소장'에서 "2023.3.3. 이민희가 돈을 갚겠다고 말하는 것을 직접 들었다"라고 기재했는데, 상대방의 다른 주장서류인 '준비서면'에서 "사실은 그 날 이민희가 그렇게 말한 것인지 기억나지 않는다"라고 기재했다면, 상대방 주장서류가 상호 일관되지 않기 때문에, 상대방의 주장은 거짓일 가능성이 높음. 이러한 자료들은 "상대방이 이민희가 돈을 갚겠다고 말했다는 거짓 주장을 하고 있다"라는 우리 주장을 뒷받침하는 것임. 
        - **주장서류 개선사항 선택 컴포넌트**(`ClaimingDocumentEnhancementSelectionComponent.tsx`)
            - 개선 방안들을 유저가 체크박스로 선택하고, 그 체크박스의 내용대로 AI Agent 가 Write mode 로 수정하는 버튼 및 기능 제공.


## 4. **상대측 입장 분석** 서브탭스크린의 UI

- 아래의 **우리측 입장 분석**의 UI를 재사용함.
      - **프로젝트분석스크린툴바**(`ProjectAnalysisScreenToolbarComponent.tsx`). 단 아래 사항은 다름. 
            - **새항목입력인터페이스** (`NewItemInputInterfaceComponent.tsx`)
              ------------
                - 이 새 항목에 대하여, **우리측 입장 분석**에서 제기 가능한 목표/주장/사실/자료들도 지적함. 그리고, "우리측 입장의 목표/주장/사실/자료도 함께 추가하시겠습니까?"라는 체크박스로 선택하게 함.
                - 이 새 항목에 대하여 **중립적 관점 분석** 에서 추가할 만한 사항이 있다면(사실/자료) 그러한 사실/자료임을 지적함. 그리고, "중립적 관점 분석에 위의 사실/자료도 함께 추가하시겠습니까?"라는 체크박스로 선택하게 함.
              ------------

      - **트리 구조 컴포넌트** (`TreeRelationshipComponent.tsx`)
      - **분석 메인 내용 컴포넌트** (`AnalysisMainComponent.tsx`)

- 다만, 아래 사항이 다름(아래는 "목표", "주장"의 예이며, 다른 항목들에 대해서도 마찬가지.). 

      - **상대방 목표 분석 텍스트 컴포넌트**(`CounterGoalAnalysisTextComponent.tsx`)
          - 상대방 목표에 대한 분석 결과 텍스트
              - 예 : "상대방이 재정신청 절차에서 기소 결정을 구하는 것인 점 및 이 프로젝트의 자료를 검토해 볼 때 .... 요소들을 검토하면 목표 달성 가능성이 매우 낮음."
              - 예 : "상대방의 ... 목표와 ... 목표는 ...라는 점에서 목적/수단 관계에 있어 보임."
              - 예 : "상대방의 목표 달성을 위한 주장 중 .... 과 .... 이 상호 모순됨. 그 이유는 ...."
          - 상대방의 목표 달성을 저지하기 위한 전략 제안               
              - 우리측에서 추가로 필요한 **목표**나 **주장**을 제시 (프로젝트데이터를 고려하여 제기가 가능하면서도 목표 달성에 효과적인 주장으로 제시)
      - **상대방 목표 반박 선택 컴포넌트**(`CounterGoalRebuttalSelectionComponent.tsx`)
          - 위 개선 방안들을 유저가 체크박스로 선택하고, 그 체크박스의 내용대로 AI Agent 가 Write mode 로 수정하는 버튼 및 기능 제공.

      -----

      - **상대방 주장 분석 텍스트 컴포넌트**(`CounterClaimAnalysisTextComponent.tsx`)
          - 상대방의 주장에 대한 분석 결과 텍스트
              - 예 : "상대방 주장의 목표가 손해배상 5,000만원 이상에 대한 인용 판결을 받는 것인데, 상대방의 이 주장은 30만원의 손해를 주장하는 것에 불과하여 목표 달성에 효과적이지 않음."
              - 예 : "상대방의 ... 주장과 상대방의 이 주장은 ...라는 점에서 서로 중복된 것으로 보임."
              - 예 : "상대방의 이 주장 중 .... 주장은 상호 모순됨. 그 이유는 ...."
          - 상대방의 주장을 반박하기 위한 전략 제안               
              - 우리측에서 추가로 필요한 **주장**이나 **증거**을 제시 (프로젝트데이터를 고려하여 제기가 가능하면서도 목표 달성에 효과적인 주장으로 제시)
      - **상대방 목표 반박 선택 컴포넌트**(`CounterClaimRebuttalSelectionComponent.tsx`)
          - 위 개선 방안들을 유저가 체크박스로 선택하고, 그 체크박스의 내용대로 AI Agent 가 Write mode 로 수정하는 버튼 및 기능 제공.


## 5. **중립적 사실관계 분석** 서브탭스크린의 UI

- 아래의 **우리측 입장 분석**의 UI를 재사용함. 다만, 아래의 차이점을 참고.
      - **프로젝트분석스크린툴바**(`ProjectAnalysisScreenToolbarComponent.tsx`) 

          - **새항목입력인터페이스** (`NewItemInputInterfaceComponent.tsx`)
              - [1] 텍스트 입력 필드 (플레이스홀더: "사실관계를 입력하세요..."). 오로지 "사실"만 입력 받음. [2] 드래그&드롭으로 프로젝트참고자료(ProjectReference)를 추가할 수 있음(이렇게 프로젝트참고자료를 추가한 경우에는 목표/주장/사실관계 스위치는 비활성화). [3] 그 하단에는 **새항목후보분석결과** 컴포넌트(`NewItemCandidateAnalysisResultComponent.tsx`). 
              - 입력한 내용이 텍스트인 경우, 목표/주장/사실 중 어느 것인지 AI가 검토하여, **새항목후보분석결과** 컴포넌트(`NewItemCandidateAnalysisResultComponent.tsx`). 에 구별 결과 및 그 이유를 안내해 주고, "사실"이 아니라, "목표"나 "주장"을 텍스트 입력한 것이라면 "이 텍스트는 주장에 해당하는 것으로 보입니다. 중립적 사실관계 분석 항목으로 "주장"을 입력하면 정확한 분석이 어려울 수 있습니다."라는 경고 메시지를 띄움. 
              - 유저가 텍스트 입력을 하면, 텍스트 입력 필드 아래에 **새항목후보분석결과** 컴포넌트(`NewItemCandidateAnalysisResultComponent.tsx`)가 보여짐.
                  - 입력을 하고 텍스트 입력 필드 옆의 "분석하기" 버튼을 누르면, 실시간으로 AI가 파악한, 새로운 입력 항목(들)의, (기존 항목과의 관계 또는 새로운 항목들 상호간의 관계)에 대한, 트리구조를 텍스트 입력창 하단에 보여 주고(이것은 어느 트리구조 항목 하에 새 항목을 삽입할 것인지 결저하게 하기 위함임), 유저가 그 트리 구조상의 드래그&드롭으로 최종 정리(예)하거나, 입력 텍스트를 수정할 기회를 주고, 입력을 확정할 것인지 선택하게 할 것. 
                  - 입력한 내용이 목표/주장/사실 중 어느 것인지에 따라, 분석 결과 점수를 미리 보여 줌. 분석 결과 점수의 구체적인 내용은 아래의  **분석 메인 내용 컴포넌트** (`AnalysisMainComponent.tsx`)에서의 분석 방법에 따름.
                  - 유저가 최종적으로 "새로운 사실 생성하기" 버튼을 누르면, 그 항목이 생성됨.  
                  - 유저가 입력한 내용이, 1개의 사실일 수도 있으나, 여러 개의 사실일 수도 있음. 여러 개의 사실인 경우, 그렇게 파악되었음 및 그 파악 이유를 유저에게 알려 주고, 각각 분할된 항목별로 순차 입력창을 다시 띄우는 것에 대해 유저가 승인하면, 각각 분할된 항목별로 순차 입력창을 다시 띄움. 
                      

      - **중립적 트리 구조 컴포넌트** (`NeutralTreeRelationshipComponent.tsx`)
          - 여기서의 중립적 트리 구조 컴포넌트는 "목표"와 "주장"을 제거한 것. "사실"들을 시간 순서로 배열.

          ├── 사실(Fact, Level 1)
          │   ├── 하위사실(SubFact, Level 2)
          │   │   └── 상세사실(DetailedFact, Level 3)
          │   ├── 증거자료(Evidence)
          │   └── 주장서류(ClaimingDocument)

 
      - **분석 메인 내용 컴포넌트** (`AnalysisMainComponent.tsx`)

          - **사실(Fact) 신뢰성 분석** (`FactAnalysisComponent.tsx`):
              - 하위 **사실(Fact)**, **증거자료(Evidence)**, **주장서류(ClaimingDocument)** 기반 신뢰성 강도 평가
              - AI는 위 **사실(Fact)**, **증거자료(Evidence)**, **주장서류(ClaimingDocument)** 기반으로 가장 중립적이고, 구체적이고, 신뢰성이 높고, 우리측 및 상대측이 각자 주장하는 사항과 관계 있는 "사실"들을 추출하여 생성.                
              - 즉, 위 내용을 반영한, 사실별 신뢰성/구체성(6하원칙 충족도 포함)/가치중립성/주장에대한기여도에 대한 **사실 분석 스코어보드** [6하원칙 충족도 표시 (예: "6하원칙 충족도: 68%")](`FactAnalysisScoreboardComponent.tsx`) 
              - **사실 분석 텍스트 컴포넌트**(`FactAnalysisTextComponent.tsx`)
                  - 신뢰성/구체성(6하원칙 충족도 포함)/가치중립성/주장에대한기여도에 대한 분석 결과 텍스트
                      - 예 : 기존 사실관계와의 관계 분석 (중복, 포함, 모순 등)
                  - 신뢰성/구체성(6하원칙 충족도 포함)/가치중립성/주장에대한기여도에 대한 개선 방안 제시
                      - 예 : 가치판단이 포함된 경우 중립적 표현 제안 
                      - 예 : 논리성/구체성(대상 **사실**의 내용 구체성 보강 방안 제시, 또는 추가할 만한 더 구체적인 하위 Fact 제시) 강화 포인트
              - **사실 개선사항 선택 컴포넌트**(`FactEnhancementSelectionComponent.tsx`)
                  - 개선 방안들을 유저가 체크박스로 선택하고, 그 체크박스의 내용대로 AI Agent 가 Write mode 로 수정하는 버튼 및 기능 제공.
              
          - **증거자료(Evidence)자체의신뢰성 및 상위사실에신뢰성기여도 종합 평가**(`EvidenceAnalysisComponent.tsx`):
              - 해당 증거자료의 작성자/내용/작성시기/형식에 입각한 증거자료 자체의 신뢰성 점수 표시(증거자료자체의신뢰성).
              - 상위 주장과의 관계에서, 해당 증거자료가 주장을 뒷받침하는 데에 얼마나 효과적으로 기여하는지 주장별로 점수를 표시(상위사실에대한신뢰성기여도).
              - 즉, 위의 2가지 내용을 반영한, 증거자료별 신뢰성/구체성/가치중립성/상위사실에대한신뢰성기여도 스코어보드 (`EvidenceAnalysisScoreboardComponent.tsx`)
              - **증거자료 분석 텍스트 컴포넌트**(`EvidenceAnalysisTextComponent.tsx`)
                  - 신뢰성/구체성(6하원칙 충족도 포함)/가치중립성/주장에대한기여도에 대한 분석 결과 텍스트
                      - 예 : 기존 사실관계와의 관계 분석 (중복, 포함, 모순 등)
                  - 신뢰성/구체성(6하원칙 충족도 포함)/가치중립성/주장에대한기여도에 대한 개선 방안 제시
                      - 예 : 가치판단이 포함된 경우 중립적 표현 제안 
                      - 예 : 논리성/구체성(대상 **사실**의 내용 구체성 보강 방안 제시, 또는 추가할 만한 더 구체적인 하위 Fact 제시) 강화 포인트
              - **증거자료 개선사항 선택 컴포넌트**(`EvidenceEnhancementSelectionComponent.tsx`)
                  - 개선 방안들을 유저가 체크박스로 선택하고, 그 체크박스의 내용대로 AI Agent 가 Write mode 로 수정하는 버튼 및 기능 제공.


## 6. **AI Agent**와의 상호 작용
  
  - 위 화면의 특정 항목을 선택한 상태에서 AI Agent 에게 질문(Ask mode)이나 생성명령(Write mode), 리뷰명령(Review mode)를 하면, 그 특정 항목에 연관된 내용들을 컨텍스트로 파악하여 AI Agent 가 작동함. 
  - 메인 화면 영역에서 '@'를 입력하면 현재 선택된 항목이 AI Agent 입력창에 인용(멘션)됨. 그러면 유저가 이어서 AI Agent 입력창에서 그 항목에 대한  질문(Ask mode)이나 생성명령(Write mode), 리뷰명령(Review mode)을 내릴 수 있는 것임. 
  - 물론 AI Agent 입력창에서 멘션 기능을 통해서 목표/주장/사실/자료들을 멘션하는 것도 가능함. 
  - 생성명령(Write mode)을 내리는 경우, 목표/주장/사실/자료들이 업데이트되고, 기존 내용과 업데이트된 내용을 비교해 보여 주면서, 승인/거부할 것인지 여부를 물어 봄. 유저는 승인/거부할 수 있으나, 둘 다 선택하지 않은 채 다시 생성명령(Write mode)을 내리는 것도 가능함. 
 


## 7. 상태 관리 및 지속성 (`AnalysisStateManagementService.ts`)
- Zustand를 활용한 상태 관리 스토어
- 서버 동기화 로직 (자동 저장 및 로드)
- 변경 이력 추적 및 실행 취소/다시 실행 기능
- 협업 상태 충돌 해결 로직


## 8. 디자인 가이드

### 8.1 컬러 스키마
- **주요 색상**:
  - 우리측 입장 분석: 파란색 계열 (#1E88E5)
  - 상대방측 입장 분석: 붉은색 계열 (#E53935)
  - 중립적 분석: 회색 계열 (#757575)
  - 목표 노드: 보라색 계열 (#7B1FA2)
  - 주장 노드: 녹색 계열 (#388E3C)
  - 증거 노드: 주황색 계열 (#F57C00)
  - 경고 메시지: 주황색 계열 (#FF9800)
  - 오류 메시지: 빨간색 계열 (#D32F2F)

### 8.2 아이콘 체계
- **노드 아이콘**:
  - 목표: 🎯 또는 적절한 SVG 아이콘
  - 주장: ⚖️ 또는 적절한 SVG 아이콘
  - 사실: 📝 또는 적절한 SVG 아이콘
  - 프로젝트참고자료: 📄 또는 적절한 SVG 아이콘

- **동작 아이콘**:
  - 추가: ➕ 또는 적절한 SVG 아이콘
  - 편집: ✏️ 또는 적절한 SVG 아이콘
  - 삭제: 🗑️ 또는 적절한 SVG 아이콘
  - 연결: 🔗 또는 적절한 SVG 아이콘
  - AI 추천: 🤖 또는 적절한 SVG 아이콘
  - AI 증거자료 추천: ⚡ 또는 적절한 SVG 아이콘

### 8.3 타이포그래피
- **폰트**:
  - 주 폰트: Noto Sans KR
  - 부 폰트: Roboto
  - 코드 폰트: JetBrains Mono

- **폰트 크기**:
  - 섹션 제목: 24px
  - 서브 제목: 18px
  - 본문 텍스트: 16px
  - 보조 텍스트: 14px
  - 노드 텍스트: 15px

### 8.4 레이아웃 및 반응형 디자인
- **레이아웃 구조**:
  - 상단 서브탭 네비게이션
  - 중앙 분석 화면 (목표-주장 트리 또는 분석내용 화면)
  - AI 추천 및 경고 인라인 표시

- **반응형 동작**:
  - 1200px 이상: 3단 레이아웃
  - 992px ~ 1199px: 2단 레이아웃 (속성 패널 축소)
  - 768px ~ 991px: 1단 레이아웃 (탭 전환식)
  - 767px 이하: 모바일 최적화 레이아웃

