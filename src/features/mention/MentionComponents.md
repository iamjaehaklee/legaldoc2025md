# 멘션드롭다운 및 멘션인라인칩 컴포넌트 (검색 기능 포함)

## 개요

이 문서에서는 법률 업무와 관련된 다양한 리소스를 선택하여 멘션하고, 이를 인라인 칩 형태로 표시하는 UI 컴포넌트인 멘션드롭다운 및 멘션인라인칩(MentionInlineChip)에 대해 설명합니다. 사용자가 드롭다운 메뉴를 통해 리소스를 선택하고, 선택된 항목을 지정된 인용 형식에 따라 인라인 칩으로 표시하는 기능을 제공합니다. 드롭다운 메뉴에는 검색 기능이 포함되어 사용자가 원하는 항목을 빠르게 찾을 수 있도록 설계됩니다. 이 기능은 법률 문서 관리 및 협업 환경에서 유용하게 활용될 수 있습니다.

## 멘션 대상

드롭다운 메뉴에서 선택 가능한 멘션 대상은 다음과 같이 구성됩니다:

- **작성문서 (EditingDocument)**  
- **증거자료 (Evidence)**
- **주장서류 (ClaimingDocument)**
- **법령 (Law)**  
- **판례 (Precedent)**  
- **참고자료 (ConsiderableDocument)**  
- **프로젝트최종결정문 (ProjectFinalJudgement)**  
- **상대방 (Opponent)**  
- **목표 (Goal)**  
- **주장 (Claim)**  
- **사실 (Fact)**  



## 컴포넌트 구조

### 멘션드롭다운 (`MentionDropdown.tsx`)

드롭다운 메뉴를 표시하는 컴포넌트로, 사용자가 리소스를 선택할 수 있도록 합니다.  
- **기능**:  
  - 멘션 대상 목록(작성문서, 프로젝트참고자료, 목표, 주장, 사실  등)을 표시하며, 각 항목은 아이콘과 함께 제공됩니다.  
  - **검색 기능**: 드롭다운 상단에 검색 입력 필드를 추가하여 사용자가 키워드를 입력하면 실시간으로 항목을 필터링합니다(항목 종류 및 파일명 등 명칭).  
    - 예: "증거" 입력 시 "증거자료"와 관련된 항목(파일명칭들)만 표시.  
    - "목표" 입력 시 "목표" 하위 항목(금전/부동산/물건/권리 획득, 청구 방어 등) 표시.  
  - 사용자가 항목을 선택하면 해당 항목이 상위 컴포넌트로 전달됩니다.  
- **UI 요소**:  
  - 검색 입력 필드 (드롭다운 상단에 위치).  
  - 드롭다운 메뉴, 항목별 아이콘, 항목 텍스트.  
  - 하위 항목(예: "증거자료" 내 파일명칭들)은 계층적으로 표시.  

### 멘션인라인칩 (`MentionInlineChip.tsx`)

선택된 리소스를 지정된 인용 형식에 따라 인라인 칩 형태로 표시하는 컴포넌트입니다.  
- **기능**:  
  - 선택된 항목을 아래 지정된 인용 형식에 따라 인라인 칩으로 표시하며, 
  - 마우스 hover 또는 클릭시 미리보기 모달[미리보기 모달의 종류는  **파일미리보기모달** (`FilePreviewModalComponent.tsx`),  **법령미리보기모달** (`LawPreviewModalComponent.tsx`), **판례미리보기모달** (`PrecedentPreviewModalComponent.tsx`), **목표주장사실미리보기모달** (`GoalClaimFactPreviewModalComponent.tsx`)]이 나타나고, 
  - 멘션인라인칩의 삭제 버튼을 통해 칩을 제거할 수 있습니다.  
  - **인용 형식**:  
    - **파일 (증거자료, 주장서류, 참고자료, 프로젝트최종결정문)**: `[@ 파일명 페이지 문단]`  
      - 예: `[@ 계약서_2024.PDF 3쪽 2문단]`  
    - **법령**: `[@ 법령명 조항번호(조항제목): 조항내용]`  
      - 예: `[@ 민법 제390조(채무불이행으로 인한 손해배상): 채무자가...]`  
    - **판례**: `[@ 법원 선고일 '선고' 판례번호 '판결' (사건명): 판례요지]`  
      - 예: `[@ 대법원 2023.5.12. 선고 2023다12345 판결 (손해배상): 계약 위반...]`  
    - **목표/주장/사실**: `[@ 목표/주장/사실]`  
      - 예: `[@ 목표: 5억원 이상의 손해배상 획득]`  
      - 예: `[@ 주장: 김용호가 매매계약 제11조를 위반하여 계약해지사유 발생]`  
      - 예: `[@ 사실: 김나래가 2023.3.12. 이명진에게 1,000만원을 계좌 이체하였음]`  
    - **상대방**: `[@ 상대방: 이름]`  
      - 예: `[@ 상대방: 박나래]`  
- **UI 요소**:  
  - 칩 형태의 UI, 삭제 버튼(선택 사항), hover 또는 클릭 가능한 영역.  

### 멘션입력 (`MentionInput.tsx`)

텍스트 입력 필드와 드롭다운을 통합하여 멘션 기능을 제공하는 상위 컴포넌트입니다.  
- **기능**:  
  - 사용자가 텍스트를 입력하는 중 특정 트리거(예: '@' 입력)를 감지하여 드롭다운을 표시하고, 선택된 항목을 지정된 인용 형식에 따라 인라인 칩으로 추가합니다.  
  - 드롭다운 내 검색 기능을 통해 사용자가 원하는 항목을 빠르게 찾을 수 있도록 지원.  
  - 파일 관련 항목(증거자료, 주장서류 등) 선택 시 페이지와 문단 정보를 추가 입력받는 UI(예: 모달 또는 입력 필드)를 제공.  
  - 법령/판례 선택 시 조항번호, 조항제목, 조항내용 또는 선고일, 판례번호, 사건명, 판례요지 정보를 자동으로 가져오거나 입력받는 UI 제공.  
- **UI 요소**:  
  - 텍스트 입력 필드, 드롭다운 메뉴, 인라인 칩.  

## 동작 흐름

1. 사용자가 텍스트 입력 필드에서 '@'와 같은 트리거 문자를 입력합니다.  
2. 트리거가 감지되면 드롭다운 메뉴가 입력 필드 아래에 표시됩니다.  
3. 드롭다운 상단의 검색 입력 필드에 키워드를 입력하면, 멘션 대상 목록이 실시간으로 필터링됩니다.  
   - 예: "법" 입력 시 "법령"이라는 멘션대상의 종류도 나오고,"법제처 연구자료 2031.PDF"라는 참고자료도 나옴.     
4. 드롭다운에서 선택이 **파일**인 경우, 파일의 페이지, 문단을 입력받는 UI가 표시됩니다.  
   - 예: "강남상가 임대차계약서.PDF"를 선택하는 경우 `DataPickerModal.tsx` 에서 "파일"탭이 선택되어 있고, 검색창에 "강남상가 임대차계약서.PDF"가 입력되어 있고, 좌측패널의 문서리스트에 "강남상가 임대차계약서.PDF"가 선택되어 있고, 따라서 우측패널의 "문서 프리뷰 영역"에 이 파일 중에 현재 화면 및 전후 맥락에 관련성이 가장 높은 부분으로 스크롤되고 그 특정 부분이 하이라이트 된 상태로 보여짐. => 유저가 위 `DataPickerModal.tsx`에서 문서의 특정 부분까지 선택하면, 선택이 완료되는 것임. [2개 이상을 선택하는 경우, 해당 개수만큼 멘션인라인칩이 생성됨]
5. 드롭다운에서 선택한 항목이 **법령**인 경우, 법령명과 조항을 입력받는 UI가 표시됩니다. 
   - 예: "주택임대차보호법"를 선택하는 경우 `DataPickerModal.tsx` 에서 검색창에 "법령"탭이 선택되어 있고, 검색창에 "주택임대차보호법"이 입력되어 있고, 좌측패널의 법령리스트에 "주택임대차보호법" 선택되어 있고, 따라서 우측패널의 "프리뷰 영역"에 이 법령 중에 현재 화면 및 전후 맥락에 관련성이 가장 높은 조항으로 스크롤되고 그 특정 조항이 하이라이트 된 상태로 보여짐. => 유저가 위 `DataPickerModal.tsx`에서 해당 조항까지 선택하면, 선택이 완료되는 것임.  [2개 이상을 선택하는 경우, 해당 개수만큼 멘션인라인칩이 생성됨]
6. 드롭다운에서 선택한 항목이 **판례**인 경우, 판례와 문단을 입력받는 UI가 표시됩니다. 
   - 예: 이 프로젝트에 대해 저장된 "대법원 2021.12.3. 선고 2021다23232 판결"를 선택하는 경우 `DataPickerModal.tsx` 에서 검색창에 "판례"탭이 선택되어 있고, 검색창에 "대법원 2021.12.3. 선고 2021다23232 판결"이 입력되어 있고, 좌측패널의 판례리스트에 "대법원 2021.12.3. 선고 2021다23232 판결" 선택되어 있고, 따라서 우측패널의 "프리뷰 영역"에 이 판례 중에 현재 화면 및 전후 맥락에 관련성이 가장 높은 문단으로 스크롤되고 그 특정 문단이 하이라이트 된 상태로 보여짐. => 유저가 위 `DataPickerModal.tsx`에서 해당 문단까지 선택하면, 선택이 완료되는 것임.  [2개 이상을 선택하는 경우, 해당 개수만큼 멘션인라인칩이 생성됨]
6. 드롭다운에서 선택한 항목이 **목표**, **주장**, **사실**인 경우, 이를 입력받는 UI가 표시됩니다. 
   - 예: 이 프로젝트의 주장 항목 중 하나인 "임차료 2회 미납으로 인한 해지 주장"을 선택하는 경우 `AnalysisItemPicker.tsx`에서 "임차료 2회 미납으로 인한 해지 주장"이 선택된 채로 보여짐. 유저가 선택 절차를 완료할 것인지 결정.  [2개 이상을 선택하는 경우, 해당 개수만큼 멘션인라인칩이 생성됨]
7. 선택 및 정보 입력이 완료되면, 지정된 인용 형식에 따라 인라인 칩이 추가됩니다.  
8. 추가된 칩은 마우스 hover 또는 클릭하여 미리보기모달을 띄우거나 삭제 버튼으로 제거할 수 있습니다.  

## 설계 고려 사항

### 멘션드롭다운 (`MentionDropdown.tsx`)

- 항목은 아이콘과 텍스트로 구성되며, 사용자가 쉽게 구분할 수 있도록 시각적 요소를 포함합니다.  
- 검색 기능은 대소문자 구분 없이 동작하며, 부분 일치 검색을 지원합니다(예: "증" 입력 시 "증거자료" 표시).  
- 계층적 구조(예: "증거자료", "주장서류" 등)를 시각적으로 구분하기 위해 들여쓰기 또는 접기/펼치기 UI를 사용.  
- 항목이 많을 경우 스크롤 가능해야 하며, 검색 결과가 없을 경우 "결과 없음" 메시지를 표시.  

### 멘션인라인칩 (`MentionInlineChip.tsx`)

- 칩은 텍스트와 조화를 이루도록 작고 간결한 디자인을 유지합니다.  
- 인용 형식에 따라 칩에 표시되는 텍스트가 달라지며, 긴 텍스트는 축약하여 표시.  
- 칩의 스타일(색상, 테두리 등)은 전체 UI와 일관성을 유지해야 합니다.  
- 마우스 우클릭 : "인용 확장/축소" 컨텍스트 토글 메뉴 - "법령"인 경우 칩 위젯에 이어서 조문 내용도 인용. "판례"인 경우 칩 위젯에 이어서 해당 문단도 인용. "파일"의 경우 칩 위젯에 이어서 해당 문단도 인용 등.


### 멘션입력 (`MentionInput.tsx`)

- 입력 필드는 일반 텍스트와 칩이 함께 표시될 수 있도록 유연하게 설계됩니다.  
- 트리거 문자를 감지하는 로직이 필요하며, 드롭다운과 칩 간의 상호작용이 매끄러워야 합니다.  

 